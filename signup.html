<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>MediMirror Signup</title>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
  <style>
    body { background: #111; color: #fff; font-family: Arial; padding: 30px; }
    .container { max-width: 500px; margin: auto; background: #1b1b1b; padding: 25px; border-radius: 15px; box-shadow: 0 0 15px rgba(0,255,255,0.2); }
    input, button, select { width: 100%; padding: 10px; margin: 10px 0; border-radius: 8px; background: #222; border: 1px solid #00ffff44; color: white; }
    button { background: linear-gradient(135deg, #00FFFF, #7F00FF); font-weight: bold; cursor: pointer; }
  </style>
</head>
<body>

<div class="container">
  <h2>📝 MediMirror Signup</h2>

  <select id="roleSelector" onchange="toggleRole()">
    <option value="patient">👤 Patient</option>
    <option value="doctor">👨‍⚕️ Doctor</option>
  </select>

  <!-- Patient Section -->
  <div id="patient-section">
    <select id="patientSignupType" onchange="togglePatientSignupType()">
      <option value="email">Signup with Email</option>
      <option value="phone">Signup with Phone</option>
    </select>

    <!-- Patient Email Signup -->
    <div id="patient-email-signup">
      <input type="email" id="patientEmail" placeholder="Email">
      <input type="password" id="patientPassword" placeholder="Password">
      <button onclick="signupPatientEmail()">Signup Patient with Email</button>
    </div>

    <!-- Patient Phone Signup -->
    <div id="patient-phone-signup" style="display:none;">
      <input type="tel" id="patientPhone" placeholder="Phone Number (+91...)">
      <button onclick="sendPatientOTP()">Send OTP</button>

      <div id="otp-section" style="display:none;">
        <input type="text" id="patientOTP" placeholder="Enter OTP">
        <button onclick="verifyPatientOTP()">Verify & Signup</button>
      </div>
    </div>
  </div>

  <!-- Doctor Section -->
  <div id="doctor-section" style="display:none;">
    <input type="text" id="doctorId" placeholder="Doctor ID (e.g. DOC1234)">
    <input type="password" id="doctorPassword" placeholder="Password">
    <button onclick="signupDoctor()">Signup Doctor</button>
  </div>
</div>

<!-- Hidden reCAPTCHA div -->
<div id="recaptcha-container" style="display:none;"></div>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyDtzfodLw2i94_MLdF8gkkU2s0covy2ec8",
    authDomain: "medimirror-12288.firebaseapp.com",
    projectId: "medimirror-12288",
    storageBucket: "medimirror-12288.appspot.com",
    messagingSenderId: "504600467699",
    appId: "1:504600467699:web:9d13f1babb484c42187f86"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  function toggleRole() {
    const role = document.getElementById("roleSelector").value;
    document.getElementById("patient-section").style.display = role === "patient" ? "block" : "none";
    document.getElementById("doctor-section").style.display = role === "doctor" ? "block" : "none";
  }

  // function togglePatientSignupType() {
  //   const type = document.getElementById("patientSignupType").value;
  //   document.getElementById("patient-email-signup").style.display = type === "email" ? "block" : "none";
  //   document.getElementById("patient-phone-signup").style.display = type === "phone" ? "block" : "none";
  // }

  // function signupDoctor() {
  //   const doctorId = document.getElementById("doctorId").value.trim();
  //   const password = document.getElementById("doctorPassword").value;
  //   const email = `${doctorId}@doctors.medimirror.com`;
  //   firebase.auth().createUserWithEmailAndPassword(email, password)
  //     .then((cred) => db.collection("users").doc(cred.user.uid).set({
  //       doctorId, email, role: "doctor", createdAt: new Date()
  //     }))
  //     .then(() => {
  //       alert("✅ Doctor Signed up!");
  //       window.location.href = "doctor-dashboard.html";
  //     })
  //     .catch(err => alert("❌ " + err.message));
  // }

  // function signupPatientEmail() {
  //   const email = document.getElementById("patientEmail").value;
  //   const password = document.getElementById("patientPassword").value;
  //   firebase.auth().createUserWithEmailAndPassword(email, password)
  //     .then((cred) => db.collection("users").doc(cred.user.uid).set({
  //       email, role: "patient", createdAt: new Date()
  //     }))
  //     .then(() => {
  //       alert("✅ Patient Signed up with Email!");
  //       window.location.href = "profile.html";
  //     })
  //     .catch(err => alert("❌ " + err.message));
  // }

  // let patientConfirmationResult;

  // window.onload = () => {
  //   window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier('recaptcha-container', { size: 'invisible' });
  //   recaptchaVerifier.render();
  // };

  // function sendPatientOTP() {
  //   const phone = document.getElementById("patientPhone").value;
  //   firebase.auth().signInWithPhoneNumber(phone, window.recaptchaVerifier)
  //     .then((result) => {
  //       patientConfirmationResult = result;
  //       document.getElementById("otp-section").style.display = "block"; // Show OTP input field after sending OTP
  //       alert("✅ OTP sent to " + phone);
  //     })
  //     .catch(err => alert("❌ OTP error: " + err.message));
  // }

  // function verifyPatientOTP() {
  //   const otp = document.getElementById("patientOTP").value;
  //   patientConfirmationResult.confirm(otp)
  //     .then((result) => db.collection("users").doc(result.user.uid).set({
  //       phone: result.user.phoneNumber,
  //       role: "patient",
  //       createdAt: new Date()
  //     }))
  //     .then(() => {
  //       alert("✅ Patient signed up with phone!");
  //       window.location.href = "profile.html";
  //     })
  //     .catch(err => alert("❌ OTP verification failed: " + err.message));
  // }
</script>
<script>
//   then(() => {
//   alert("✅ Signup successful! Please complete your profile.");
//   window.location.href = "profile.html";
// })

</script>

</body>
</html>
